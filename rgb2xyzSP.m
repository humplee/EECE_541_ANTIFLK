% function XYZ = rgb2xyz (RGB)
% 
% src:1 input image BT.2020
% scr:0 input image BT.709
function ImgXYZ = rgb2xyzSP(ImgRGB,src)
if src==1
     RGB2XYZ = [...
        0.636958     0.144617     0.168881 ;...
        0.262700     0.677998     0.059302 ;...
        0.000000     0.028073     0.060985 ;...
        ];

    check13Color(ImgRGB);
    ImgXYZ = ImgRGB;
    for Cc = 1 : 3
        ImgXYZ(:,:,Cc) = RGB2XYZ(1,Cc) * ImgRGB(:,:,1) +...
                         RGB2XYZ(2,Cc) * ImgRGB(:,:,2) +...
                         RGB2XYZ(3,Cc) * ImgRGB(:,:,3) ;
    end
    
elseif src==0;
    RGB2XYZ = [...
        0.412391     0.357584     0.180481;...
        0.212639     0.715169     0.072192 ;...
        0.019331     0.119195     0.950532 ;...
        ];

    check13Color(ImgRGB);
    ImgXYZ = ImgRGB;
    for Cc = 1 : 3
        ImgXYZ(:,:,Cc) = RGB2XYZ(1,Cc) * ImgRGB(:,:,1) +...
                         RGB2XYZ(2,Cc) * ImgRGB(:,:,2) +...
                         RGB2XYZ(3,Cc) * ImgRGB(:,:,3) ;
    end
end
end