%scr:1 output image BT.2020
%src:0 output image BT.709
function RGB = xyz2rgbSP (XYZ,src)
if src==1
     XYZ2RGB = [...
        1.716651      -0.355671      -0.253366  ;...
        -0.666684      1.616481       0.015768  ;...
        0.017640      -0.042771       0.942103  ;...
        ];

    check13Color(XYZ);
    RGB = XYZ;
    for Cc = 1 : 3
        RGB(:,:,Cc) = XYZ2RGB(1,Cc) * XYZ(:,:,1) +...
                         XYZ2RGB(2,Cc) * XYZ(:,:,2) +...
                         XYZ2RGB(3,Cc) * XYZ(:,:,3) ;
    end
    
elseif src==0;
    XYZ2RGB = [...
        3.240970       -1.537383      -0.498611 ;...
        -0.969244       1.875968      0.041555  ;...
        0.055630        0.203977      1.056972  ;...
        ];

    check13Color(XYZ);
    RGB = XYZ;
    for Cc = 1 : 3
        RGB(:,:,Cc) = XYZ2RGB(1,Cc) * XYZ(:,:,1) +...
                         XYZ2RGB(2,Cc) * XYZ(:,:,2) +...
                         XYZ2RGB(3,Cc) * XYZ(:,:,3) ;
    end
end
end